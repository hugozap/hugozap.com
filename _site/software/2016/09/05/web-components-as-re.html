<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Web Components as React leaf nodes | hugozap Hugo Zapata</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Web Components as React leaf nodes" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="There’s been a lot of discussion regarding the usage of Web Components and their relation with frameworks. As usual in the tech community, people (myself included) sometimes attach their identities to some particular technology and that prevents a healthy discussion." />
<meta property="og:description" content="There’s been a lot of discussion regarding the usage of Web Components and their relation with frameworks. As usual in the tech community, people (myself included) sometimes attach their identities to some particular technology and that prevents a healthy discussion." />
<link rel="canonical" href="https://hugozap.com/software/2016/09/05/web-components-as-re.html" />
<meta property="og:url" content="https://hugozap.com/software/2016/09/05/web-components-as-re.html" />
<meta property="og:site_name" content="hugozap Hugo Zapata" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-09-05T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"There’s been a lot of discussion regarding the usage of Web Components and their relation with frameworks. As usual in the tech community, people (myself included) sometimes attach their identities to some particular technology and that prevents a healthy discussion.","@type":"BlogPosting","url":"https://hugozap.com/software/2016/09/05/web-components-as-re.html","headline":"Web Components as React leaf nodes","dateModified":"2016-09-05T00:00:00-05:00","datePublished":"2016-09-05T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://hugozap.com/software/2016/09/05/web-components-as-re.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://hugozap.com/feed.xml" title="hugozap | Hugo Zapata" /></head>
<body class="w-100 sans-serif bg-white"><header class="bg-black-90  fixed top-0 w-100 ph3 pv3 pv4-ns ph4-m ph5-l z-2"><nav class="f6 fw6 ttu tracked tl tr-ns relative tc">
    <a class="relative block absolute-ns dib-ns left-0 link dim white " href="/">hugozap | Hugo Zapata</a><a class="link dim white dib mr3" href="/about/" title="About">About</a></nav></header>

<main class="ph3 pv5 pa5-ns mt3 mt5-ns" aria-label="Content">
        <article class="measure-wide lh-copy" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <h1 class="f3 f2-m f1-l" itemprop="name headline">Web Components as React leaf nodes</h1>
    <p class="">
      <time class="" datetime="2016-09-05T00:00:00-05:00" itemprop="datePublished">Sep 5, 2016
      </time></p>
  </header>
  <p class="lh-copy">
    <p>There’s been a lot of discussion regarding the usage of Web Components and their relation with frameworks. As usual in the tech community, people (myself included) sometimes attach their identities to some particular technology and that prevents a healthy discussion.</p>

<p>After some thought I see the value in working with Web Components and using them with current tools/frameworks/libraries. The good thing about Web components is that they can be used in the same way other html elements are used. Common tasks like handling events work the same way as normal DOM elements(myCustomEl.addEventListener) and because WC is a platform feature (with increasing support in all modern browsers) everybody benefits.</p>

<p>Having used Polymer a lot in the past I had some confussion regarding compatibility with React components. My problem was that (like a lot of devs) all the exposure I’ve had to Web Components has been through Polymer and because Polymer uses additional abstractions and has it’s own established development workflow (somewhat separated from the current ecosystem) it was not easy to imagine how to use WC outside of the Polymer way of doing things.</p>

<p>Recently I found about the <a href="https://aframe.io/">a-frame</a> project. A really interesting VR library for the web that uses Web Components to create scenes in a declarative way. I wanted to try it with a simple react skeleton app ( created using create-react-app ).</p>

<p>I searched for a-frame react and found <a href="https://github.com/ngokevin/aframe-react">aframe-react</a> a project that converts some of the a-frame primitives to React elements. Curious about what’s required to do the conversion I checked <a href="https://github.com/ngokevin/aframe-react/blob/master/src/index.js">https://github.com/ngokevin/aframe-react/blob/master/src/index.js</a> and there’s nothing misterious about it. For example:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">Scene</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="kr">static</span> <span class="nx">propTypes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">onEnterVR</span><span class="p">:</span> <span class="nx">React</span><span class="p">.</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">,</span>
    <span class="na">onExitVR</span><span class="p">:</span> <span class="nx">React</span><span class="p">.</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">,</span>
    <span class="na">onLoaded</span><span class="p">:</span> <span class="nx">React</span><span class="p">.</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span>
  <span class="p">};</span>

  <span class="kr">static</span> <span class="nx">defaultProps</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">onEnterVR</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{},</span>
    <span class="na">onExitVR</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{},</span>
    <span class="na">onLoaded</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{}</span>
  <span class="p">};</span>

  <span class="nx">attachEvents</span> <span class="o">=</span> <span class="nx">el</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'enter-vr'</span><span class="p">,</span> <span class="nx">event</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">onEnterVR</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
      <span class="p">});</span>
      <span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'exit-vr'</span><span class="p">,</span> <span class="nx">event</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">onExitVR</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
      <span class="p">});</span>
      <span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'loaded'</span><span class="p">,</span> <span class="nx">event</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">onLoaded</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">a</span><span class="o">-</span><span class="nx">scene</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">attachEvents</span><span class="p">}</span> <span class="p">{...</span><span class="nx">serializeComponents</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">)}</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">}</span>
      <span class="o">&lt;</span><span class="sr">/a-scene</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The Custom Web Component element is a-scene and you can see it’s being used normally in the render method. The serializeComponents(this.props) call is just a utility method that stringifies components passed as an object, so: someAttr={primitive: box; width: 10} becomes someAttr=’primitive: box; width: 10’</p>

<p>For it to work, the a-scene element must be registered previously. That can be done by importing the ‘aframe’ module or including the script tag in the index.html</p>

<p>I did a quick example including <a href="https://github.com/chenglou/react-motion">react-motion</a> (physics based animation using springs) and it worked great.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'react'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">logo</span> <span class="k">from</span> <span class="s1">'./logo.svg'</span><span class="p">;</span>
<span class="k">import</span> <span class="s1">'./App.css'</span><span class="p">;</span>
<span class="k">import</span> <span class="s1">'aframe'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">Scene</span><span class="p">,</span> <span class="nx">Entity</span><span class="p">,</span> <span class="nx">Sky</span><span class="p">}</span> <span class="k">from</span> <span class="s1">'aframe-react'</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">Motion</span><span class="p">,</span><span class="nx">spring</span><span class="p">}</span> <span class="k">from</span> <span class="s1">'react-motion'</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">App</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">spherePos</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">x</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="na">y</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="na">z</span><span class="p">:</span><span class="mi">0</span>
      <span class="p">}</span>
    <span class="p">}</span>

  <span class="p">}</span>

  <span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
      <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="mi">10</span>
      <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="mi">10</span>
      <span class="kd">var</span> <span class="nx">z</span> <span class="o">=</span> <span class="mi">10</span><span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="mi">10</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
        <span class="na">spherePos</span><span class="p">:</span> <span class="p">{</span>
          <span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">,</span><span class="nx">z</span>
        <span class="p">}</span>
      <span class="p">})</span>
    <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="mi">600</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">Scene</span><span class="o">&gt;</span> 
          <span class="o">&lt;</span><span class="nx">Motion</span> <span class="nx">defaultStyle</span><span class="o">=</span> <span class="nx">style</span><span class="o">=&gt;</span>
            <span class="p">{</span><span class="nx">value</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nx">Entity</span> <span class="nx">geometry</span><span class="o">=</span> <span class="nx">material</span><span class="o">=</span> <span class="nx">position</span><span class="o">=</span><span class="p">{[</span><span class="nx">value</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span><span class="nx">value</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span><span class="o">-</span><span class="nx">value</span><span class="p">.</span><span class="nx">z</span><span class="p">]}</span><span class="sr">/&gt;</span><span class="err">}
</span>          <span class="o">&lt;</span><span class="sr">/Motion</span><span class="err">&gt;
</span>          
          <span class="p">....</span> <span class="nx">Duplicated</span> <span class="nx">non</span> <span class="nx">interesting</span> <span class="nx">code</span> <span class="nx">cut</span> <span class="p">...</span>

          <span class="o">&lt;</span><span class="nx">Entity</span> <span class="nx">camera</span><span class="o">=</span><span class="s2">"userHeight: 1.8"</span> <span class="nx">look</span><span class="o">-</span><span class="nx">controls</span> <span class="nx">position</span><span class="o">=</span><span class="p">{[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">]}</span><span class="o">&gt;&lt;</span><span class="sr">/Entity</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="nx">Entity</span> <span class="nx">geometry</span><span class="o">=</span>
          <span class="nx">material</span><span class="o">=</span><span class="s2">"color: cyan; metalness: 0.7"</span><span class="o">&gt;&lt;</span><span class="sr">/Entity</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="nx">Entity</span> <span class="nx">sky</span><span class="o">=</span><span class="s2">" "</span> <span class="o">/&gt;</span>
       <span class="o">&lt;</span><span class="sr">/Scene</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">App</span><span class="p">;</span>
</code></pre></div></div>
<p><a href="https://gist.github.com/hugozap/da13f467352fe127c6c47e9ad754ebcb">source here</a>
This is the result</p>

<blockquote class="twitter-video" data-lang="es"><p lang="en" dir="ltr">React Motion can be used to add physics based animation (spring) to a-frame apps for cool VR or 3D experiences. <a href="https://t.co/KxTh3JbbvM">pic.twitter.com/KxTh3JbbvM</a></p>&mdash; Hugo Zapata (@hugozap) <a href="https://twitter.com/hugozap/status/772298823582437376">4 de septiembre de 2016</a></blockquote>
<script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>One of the misconceptions I had with WC is thinking HTML Imports are required (because that’s what Polymer components use). That’s not true from what I’ve seen. Just make sure at some point registerElement is called for the custom web component (Usually that’s done by the WC npm module)</p>

<p>I hope to keep learning about new usage patters and how to integrate WC in my workflow. Fortunately from what I’ve seen in recent twitter threads, the Chrome developer relations team is commited to keep promoting WC and their integration with the current ecosystem.</p>


  </p>
  <a class="" href="/software/2016/09/05/web-components-as-re.html" hidden></a>

</article>


    </main></body>

</html>
